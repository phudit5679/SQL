<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="D:/project/database.sqlite" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="27941"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,6:mainPlayer"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Country" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="42"/><column index="2" value="75"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="League" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="2" mode="1"/></sort><column_widths><column index="1" value="42"/><column index="2" value="78"/><column index="3" value="157"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Match" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="3" mode="1"/></sort><column_widths><column index="1" value="40"/><column index="2" value="78"/><column index="3" value="70"/><column index="4" value="68"/><column index="5" value="45"/><column index="6" value="129"/><column index="7" value="94"/><column index="8" value="130"/><column index="9" value="130"/><column index="10" value="119"/><column index="11" value="119"/><column index="12" value="117"/><column index="13" value="117"/><column index="14" value="117"/><column index="15" value="117"/><column index="16" value="117"/><column index="17" value="117"/><column index="18" value="117"/><column index="19" value="117"/><column index="20" value="117"/><column index="21" value="125"/><column index="22" value="125"/><column index="23" value="117"/><column index="24" value="117"/><column index="25" value="117"/><column index="26" value="117"/><column index="27" value="117"/><column index="28" value="117"/><column index="29" value="117"/><column index="30" value="117"/><column index="31" value="117"/><column index="32" value="125"/><column index="33" value="125"/><column index="34" value="117"/><column index="35" value="117"/><column index="36" value="117"/><column index="37" value="117"/><column index="38" value="117"/><column index="39" value="117"/><column index="40" value="117"/><column index="41" value="117"/><column index="42" value="117"/><column index="43" value="125"/><column index="44" value="125"/><column index="45" value="117"/><column index="46" value="117"/><column index="47" value="117"/><column index="48" value="117"/><column index="49" value="117"/><column index="50" value="117"/><column index="51" value="117"/><column index="52" value="117"/><column index="53" value="117"/><column index="54" value="125"/><column index="55" value="125"/><column index="56" value="108"/><column index="57" value="108"/><column index="58" value="108"/><column index="59" value="108"/><column index="60" value="108"/><column index="61" value="108"/><column index="62" value="108"/><column index="63" value="108"/><column index="64" value="108"/><column index="65" value="116"/><column index="66" value="116"/><column index="67" value="108"/><column index="68" value="108"/><column index="69" value="108"/><column index="70" value="108"/><column index="71" value="108"/><column index="72" value="108"/><column index="73" value="108"/><column index="74" value="108"/><column index="75" value="108"/><column index="76" value="116"/><column index="77" value="116"/><column index="78" value="40"/><column index="79" value="53"/><column index="80" value="55"/><column index="81" value="78"/><column index="82" value="40"/><column index="83" value="43"/><column index="84" value="51"/><column index="85" value="79"/><column index="86" value="49"/><column index="87" value="49"/><column index="88" value="50"/><column index="89" value="40"/><column index="90" value="40"/><column index="91" value="40"/><column index="92" value="40"/><column index="93" value="40"/><column index="94" value="40"/><column index="95" value="40"/><column index="96" value="40"/><column index="97" value="40"/><column index="98" value="40"/><column index="99" value="40"/><column index="100" value="40"/><column index="101" value="40"/><column index="102" value="40"/><column index="103" value="40"/><column index="104" value="40"/><column index="105" value="40"/><column index="106" value="40"/><column index="107" value="40"/><column index="108" value="40"/><column index="109" value="40"/><column index="110" value="40"/><column index="111" value="40"/><column index="112" value="40"/><column index="113" value="40"/><column index="114" value="40"/><column index="115" value="40"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Player" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="40"/><column index="2" value="95"/><column index="3" value="192"/><column index="4" value="124"/><column index="5" value="129"/><column index="6" value="49"/><column index="7" value="52"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Player_Attributes" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="40"/><column index="2" value="124"/><column index="3" value="95"/><column index="4" value="129"/><column index="5" value="99"/><column index="6" value="66"/><column index="7" value="106"/><column index="8" value="145"/><column index="9" value="147"/><column index="10" value="62"/><column index="11" value="61"/><column index="12" value="126"/><column index="14" value="53"/><column index="15" value="63"/><column index="16" value="45"/><column index="17" value="134"/><column index="18" value="92"/><column index="19" value="84"/><column index="20" value="88"/><column index="21" value="93"/><column index="22" value="47"/><column index="23" value="69"/><column index="24" value="58"/><column index="25" value="86"/><column index="26" value="58"/><column index="27" value="59"/><column index="28" value="65"/><column index="29" value="79"/><column index="30" value="79"/><column index="31" value="94"/><column index="32" value="78"/><column index="33" value="45"/><column index="34" value="67"/><column index="35" value="59"/><column index="36" value="111"/><column index="37" value="95"/><column index="38" value="69"/><column index="39" value="85"/><column index="40" value="74"/><column index="41" value="101"/><column index="42" value="83"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Team" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="2" mode="1"/></sort><column_widths><column index="1" value="42"/><column index="2" value="87"/><column index="3" value="116"/><column index="4" value="173"/><column index="5" value="127"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Team_Attributes" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="40"/><column index="2" value="116"/><column index="3" value="87"/><column index="4" value="129"/><column index="5" value="121"/><column index="6" value="154"/><column index="7" value="137"/><column index="8" value="170"/><column index="9" value="130"/><column index="10" value="163"/><column index="11" value="184"/><column index="12" value="158"/><column index="13" value="191"/><column index="14" value="164"/><column index="15" value="197"/><column index="16" value="166"/><column index="17" value="199"/><column index="18" value="212"/><column index="19" value="118"/><column index="20" value="151"/><column index="21" value="133"/><column index="22" value="166"/><column index="23" value="132"/><column index="24" value="165"/><column index="25" value="179"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sqlite_sequence" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="104"/><column index="2" value="49"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">-- list of League from country
SELECT c.name AS country, l.name AS leage_name FROM Country c
JOIN League l
ON c.id = l.country_id;


-- จำจวนทีมในแต่ละลีค
SELECT l.name AS league_name, COUNT(DISTINCT t.team_api_id) AS team_count
FROM League l
JOIN Match m ON l.id = m.league_id
JOIN Team t ON m.home_team_api_id = t.team_api_id
GROUP BY l.name
ORDER BY team_count DESC;

--over all ของนักเตะที่สูงที่สุด 10 อันดับ
SELECT p.player_name, MAX(pa.overall_rating)AS overall_rating FROM Player_Attributes pa,Player p
WHERE pa.player_api_id = p.player_api_id
GROUP BY p.player_name
ORDER BY overall_rating DESC LIMIT 10;

--จำนวนทีมที่ชนะในบ้านมากสุด10อันดับ
SELECT t.team_long_name, COUNT(m.home_team_api_id)  FROM Team t
JOIN Match m
ON t.team_api_id = m.home_team_api_id
WHERE m.home_team_goal &gt; m.away_team_goal 
GROUP BY 1
ORDER BY COUNT(m.home_team_api_id) DESC
LIMIT 10;

--จำนวนทีมที่ชนะนอกบ้านมากที่สุด
SELECT t.team_long_name, COUNT(m.away_team_api_id)  FROM Team t
JOIN Match m
ON t.team_api_id = m.away_team_api_id
WHERE m.home_team_goal &lt; m.away_team_goal 
GROUP BY 1
ORDER BY COUNT(m.away_team_api_id) DESC
LIMIT 10;

--จำนวนทีมที่ชนะมากที่สุดใน ฤดูกาล2015/2016
SELECT 
    t.team_long_name, 
    COUNT(DISTINCT m.match_api_id) AS total_wins
FROM 
    Match m
JOIN 
    Team t 
    ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
WHERE 
    ((m.home_team_goal &gt; m.away_team_goal AND t.team_api_id = m.home_team_api_id) OR
    (m.away_team_goal &gt; m.home_team_goal AND t.team_api_id = m.away_team_api_id))
    AND m.season = '2015/2016'
GROUP BY 
    t.team_long_name
ORDER BY 
    total_wins DESC
LIMIT 16;

--ชนะรวมทั้งหมดจำแนกตามซีวั่น ของแมนยู
SELECT m.season,
    t.team_long_name, 
    COUNT(DISTINCT m.match_api_id) AS total_wins
FROM 
    Match m
JOIN 
    Team t 
    ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
WHERE 
    ((m.home_team_goal &gt; m.away_team_goal AND t.team_api_id = m.home_team_api_id) OR
    (m.away_team_goal &gt; m.home_team_goal AND t.team_api_id = m.away_team_api_id))
    AND t.team_long_name = 'Manchester United'
GROUP BY 
    t.team_long_name, m.season
ORDER BY 
    total_wins DESC
LIMIT 16;

--แมนยูชนะในบ้านจำแนกตามฤดูกาล
SELECT m.season, t.team_long_name, COUNT(*)
FROM Team t
JOIN Match m ON t.team_api_id = m.home_team_api_id
WHERE m.home_team_goal &gt; m.away_team_goal AND t.team_long_name = 'Manchester United'
GROUP BY m.season, t.team_long_name;
--แมนยูดชนะนอกบ้านตามฤดูกาล
SELECT m.season, t.team_long_name, COUNT(m.away_team_api_id)
FROM (Team t
JOIN Match m ON t.team_api_id = m.away_team_api_id
WHERE m.home_team_goal &lt; m.away_team_goal AND t.team_long_name = 'Manchester United'
GROUP BY m.season, t.team_long_name);</sql><sql name="SQL 3">-- list of League from country
SELECT c.name AS country_name, l.name AS leage_name FROM Country c
JOIN League l
ON c.id = l.country_id;


-- จำจวนทีมในแต่ละลีค
SELECT l.name AS league_name, COUNT(DISTINCT t.team_api_id) AS team_count
FROM League l
JOIN Match m ON l.id = m.league_id
JOIN Team t ON m.home_team_api_id = t.team_api_id
GROUP BY l.name
ORDER BY team_count DESC;

--over all ของนักเตะที่สูงที่สุด 10 อันดับ
SELECT p.player_name, MAX(pa.overall_rating)AS overall_rating FROM Player_Attributes pa,Player p
WHERE pa.player_api_id = p.player_api_id
GROUP BY p.player_name
ORDER BY overall_rating DESC LIMIT 10;

--จำนวนทีมที่ชนะในบ้านมากสุด10อันดับ
SELECT t.team_long_name, COUNT(m.home_team_api_id)  FROM Team t
JOIN Match m
ON t.team_api_id = m.home_team_api_id
WHERE m.home_team_goal &gt; m.away_team_goal 
GROUP BY 1
ORDER BY COUNT(m.home_team_api_id) DESC
LIMIT 10;

--ชนะรวมทั้งหมดจำแนกตามซีวั่น ของแมนยู
SELECT m.season,
    t.team_long_name, 
    COUNT(DISTINCT m.match_api_id) AS total_wins
FROM 
    Match m
JOIN 
    Team t 
    ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
WHERE 
    ((m.home_team_goal &gt; m.away_team_goal AND t.team_api_id = m.home_team_api_id) OR
    (m.away_team_goal &gt; m.home_team_goal AND t.team_api_id = m.away_team_api_id))
    AND t.team_long_name = 'Manchester United'
GROUP BY 
    t.team_long_name, m.season
ORDER BY 
    total_wins DESC;

--แมนยูชนะในบ้านจำแนกตามฤดูกาล
SELECT m.season, t.team_long_name, COUNT(*)
FROM Team t
JOIN Match m ON t.team_api_id = m.home_team_api_id
WHERE m.home_team_goal &gt; m.away_team_goal AND t.team_long_name = 'Manchester United'
GROUP BY m.season, t.team_long_name;
--แมนยูดชนะนอกบ้านตามฤดูกาล
SELECT m.season, t.team_long_name, COUNT(m.away_team_api_id)
FROM Team t
JOIN Match m ON t.team_api_id = m.away_team_api_id
WHERE m.home_team_goal &lt; m.away_team_goal AND t.team_long_name = 'Manchester United'
GROUP BY m.season, t.team_long_name;</sql><sql name="SQL 4">-- list of League from country
SELECT c.name AS country_name, l.name AS leage_name FROM Country c
JOIN League l
ON c.id = l.country_id;


-- จำจวนทีมในแต่ละลีค
SELECT l.name AS league_name, COUNT(DISTINCT t.team_api_id) AS team_count
FROM League l
JOIN Match m ON l.id = m.league_id
JOIN Team t ON m.home_team_api_id = t.team_api_id
GROUP BY l.name
ORDER BY team_count DESC;

--over all ของนักเตะที่สูงที่สุด 10 อันดับ
SELECT p.player_name, MAX(pa.overall_rating)AS overall_rating FROM Player_Attributes pa,Player p
WHERE pa.player_api_id = p.player_api_id
GROUP BY p.player_name
ORDER BY overall_rating DESC LIMIT 10;

--จำนวนทีมที่ชนะมากที่สุดในทุกฤดูกาล
SELECT 
    t.team_long_name, 
    COUNT(DISTINCT m.match_api_id) AS total_win
FROM 
    Match m
JOIN 
    Team t 
    ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
WHERE 
    (m.home_team_goal &gt; m.away_team_goal AND t.team_api_id = m.home_team_api_id) OR
    (m.away_team_goal &gt; m.home_team_goal AND t.team_api_id = m.away_team_api_id)
    
GROUP BY 
    t.team_long_name
ORDER BY 
    total_win DESC
LIMIT 10;

--จำนวนทีมที่ชนะมากที่สุดใน ฤดูกาล2015/2016
SELECT 
    t.team_long_name, 
    COUNT(DISTINCT m.match_api_id) AS total_wins
FROM 
    Match m
JOIN 
    Team t 
    ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
WHERE 
    ((m.home_team_goal &gt; m.away_team_goal AND t.team_api_id = m.home_team_api_id) OR
    (m.away_team_goal &gt; m.home_team_goal AND t.team_api_id = m.away_team_api_id))
    AND m.season = '2015/2016'
GROUP BY 
    t.team_long_name
ORDER BY 
    total_wins DESC
LIMIT 10;

--
SELECT m.season,
    t.team_long_name, 
    COUNT(DISTINCT m.match_api_id) AS total_wins
FROM 
    Match m
JOIN 
    Team t 
    ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
WHERE 
    ((m.home_team_goal &gt; m.away_team_goal AND t.team_api_id = m.home_team_api_id) OR
    (m.away_team_goal &gt; m.home_team_goal AND t.team_api_id = m.away_team_api_id))
    AND t.team_long_name = 'Manchester United'
GROUP BY 
    t.team_long_name, m.season;

--แมนยูชนะในบ้านจำแนกตามฤดูกาล
SELECT m.season, t.team_long_name, COUNT(m.home_team_api_id) AS home_win
FROM Team t
JOIN Match m ON t.team_api_id = m.home_team_api_id
WHERE m.home_team_goal &gt; m.away_team_goal AND t.team_long_name = 'Manchester United'
GROUP BY m.season, t.team_long_name;
--แมนยูดชนะนอกบ้านตามฤดูกาล
SELECT m.season, t.team_long_name, COUNT(m.away_team_api_id) AS away_win
FROM Team t
JOIN Match m ON t.team_api_id = m.away_team_api_id
WHERE m.home_team_goal &lt; m.away_team_goal AND t.team_long_name = 'Manchester United'
GROUP BY m.season, t.team_long_name;
</sql><current_tab id="2"/></tab_sql></sqlb_project>
